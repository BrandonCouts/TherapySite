<% include ../../partials/header %>
<style>
	.table-contact tr:nth-child(1) td {
		background: rgba(0, 0, 128, 0.4);
	}
	.table-contact tr:nth-child(2) td {
		background: rgba(0, 0, 255, 0.4);
	}
	.table-contact tr:nth-child(3) td {
		background: rgba(127,127,127,0.4);
	}
	.table-contact tr:nth-child(4) td {
		background: rgba(255, 63, 0, 0.4);
	}
	.table-contact tr:nth-child(5) td {
		background: rgba(255, 0, 0, 0.4);
	}
</style>
	<% include ../../partials/dashboardIdent %>
	<% include ../../partials/dashboardNav %>
	<div class="container-fluid content mb-3">
		<div class="row">
			<div class="col">
				<%
				function sortByName(a,b) { a=a.name.toLowerCase(); b=b.name.toLowerCase(); if( a > b )return 1; if( a < b ) return -1; return 0; }
				var cGs = [
					[
						contacts.filter( c => c.contact_type == "alliance" 		&& c.standing == 10).sort(sortByName),
						contacts.filter( c => c.contact_type == "corporation" 	&& c.standing == 10).sort(sortByName),
						contacts.filter( c => c.contact_type == "character" 	&& c.standing == 10).sort(sortByName)
					],
					[
						contacts.filter( c => c.contact_type == "alliance" 		&& c.standing == 5).sort(sortByName),
						contacts.filter( c => c.contact_type == "corporation" 	&& c.standing == 5).sort(sortByName),
						contacts.filter( c => c.contact_type == "character" 	&& c.standing == 5).sort(sortByName)
					],
					[
						contacts.filter( c => c.contact_type == "alliance" 		&& c.standing == 0).sort(sortByName),
						contacts.filter( c => c.contact_type == "corporation" 	&& c.standing == 0).sort(sortByName),
						contacts.filter( c => c.contact_type == "character" 	&& c.standing == 0).sort(sortByName)
					],
					[
						contacts.filter( c => c.contact_type == "alliance" 		&& c.standing == -5).sort(sortByName),
						contacts.filter( c => c.contact_type == "corporation" 	&& c.standing == -5).sort(sortByName),
						contacts.filter( c => c.contact_type == "character" 	&& c.standing == -5).sort(sortByName)
					],
					[
						contacts.filter( c => c.contact_type == "alliance" 		&& c.standing == -10).sort(sortByName),
						contacts.filter( c => c.contact_type == "corporation" 	&& c.standing == -10).sort(sortByName),
						contacts.filter( c => c.contact_type == "character" 	&& c.standing == -10).sort(sortByName)
					]
				] %>
				<%
					function jsUcfirst(string)
					{
						return string.charAt(0).toUpperCase() + string.slice(1);
					}
					function renderMember(c) {
						let id = c.contact_id;
						let ext = ( c.contact_type == 'character')? 'jpg': 'png';

						return '<div style="position: relative;display: inline-block">' +
								'<img src="//image.eveonline.com/' + c.contact_type + '/' + c.contact_id + '_128.' + ext + '" style="width:128px; height: 128px;">' +
								'<div style="position: absolute;left: 0; bottom: 0; right: 0;">' + c.name + '</div>' +
								'</div>';
					}
				%>

				<h4>Contacts</h4>
				<table class="table table-contact table-sm text-center" width="100%">
					<tbody>
					<tr>
						<% var i; %>
						<td><div class="d-flex align-items-start flex-wrap"><% for( i = 0; i < cGs[0][0].length; i++ ) { %><%- renderMember(cGs[0][0][i]); %><% } %></div></td>
						<td><div class="d-flex flex-wrap"><% for( i = 0; i < cGs[0][1].length; i++ ) { %><%- renderMember(cGs[0][1][i]); %><% } %></div></td>
						<td><div class="d-flex flex-wrap"><% for( i = 0; i < cGs[0][2].length; i++ ) { %><%- renderMember(cGs[0][2][i]); %><% } %></div></td>
					</tr>
					<tr>
						<td><div class="d-flex flex-wrap"><% for( i = 0; i < cGs[1][0].length; i++ ) { %><%- renderMember(cGs[1][0][i]); %><% } %></div></td>
						<td><div class="d-flex flex-wrap"><% for( i = 0; i < cGs[1][1].length; i++ ) { %><%- renderMember(cGs[1][1][i]); %><% } %></div></td>
						<td><div class="d-flex flex-wrap"><% for( i = 0; i < cGs[1][2].length; i++ ) { %><%- renderMember(cGs[1][2][i]); %><% } %></div></td>
					</tr>
					<tr>
						<td><div class="d-flex flex-wrap"><% for( i = 0; i < cGs[2][0].length; i++ ) { %><%- renderMember(cGs[2][0][i]); %><% } %></div></td>
						<td><div class="d-flex flex-wrap"><% for( i = 0; i < cGs[2][1].length; i++ ) { %><%- renderMember(cGs[2][1][i]); %><% } %></div></td>
						<td><div class="d-flex flex-wrap"><% for( i = 0; i < cGs[2][2].length; i++ ) { %><%- renderMember(cGs[2][2][i]); %><% } %></div></td>
					</tr>
					<tr>
						<td><div class="d-flex flex-wrap"><% for( i = 0; i < cGs[3][0].length; i++ ) { %><%- renderMember(cGs[3][0][i]); %><% } %></div></td>
						<td><div class="d-flex flex-wrap"><% for( i = 0; i < cGs[3][1].length; i++ ) { %><%- renderMember(cGs[3][1][i]); %><% } %></div></td>
						<td><div class="d-flex flex-wrap"><% for( i = 0; i < cGs[3][2].length; i++ ) { %><%- renderMember(cGs[3][2][i]); %><% } %></div></td>
					</tr>
					<tr>
						<td><div class="d-flex align-items-start flex-wrap"><% for( i = 0; i < cGs[4][0].length; i++ ) { %><%- renderMember(cGs[4][0][i]); %><% } %></div></td>
						<td><div class="d-flex align-items-start flex-wrap"><% for( i = 0; i < cGs[4][1].length; i++ ) { %><%- renderMember(cGs[4][1][i]); %><% } %></div></td>
						<td><div class="d-flex align-items-start flex-wrap"><% for( i = 0; i < cGs[4][2].length; i++ ) { %><%- renderMember(cGs[4][2][i]); %><% } %></div></td>
					</tr>
					</tbody>
				</table>
			</div>
		</div>
	</div>
<% include ../../partials/footer %>